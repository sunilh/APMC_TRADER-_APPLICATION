<!DOCTYPE html>
<html>
<head>
    <title>Test Buyer Billing Data</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .data { background: #f5f5f5; padding: 10px; margin: 10px 0; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <h1>Buyer Billing Test Data</h1>
    
    <div class="section">
        <h2>1. Your Current Buyers</h2>
        <div id="buyers-data" class="data">Loading...</div>
    </div>
    
    <div class="section">
        <h2>2. Your Completed Lots</h2>
        <div id="lots-data" class="data">Loading...</div>
    </div>
    
    <div class="section">
        <h2>3. Bag Weights Data</h2>
        <div id="bags-data" class="data">Loading...</div>
    </div>
    
    <div class="section">
        <h2>4. Buyer Bills (What Should Show)</h2>
        <div id="bills-data" class="data">Loading...</div>
    </div>

    <script>
        // Test function to fetch and display data
        async function testBuyerBilling() {
            try {
                // Get buyers
                const buyersRes = await fetch('/api/buyers');
                const buyers = await buyersRes.json();
                document.getElementById('buyers-data').innerHTML = 
                    `<pre>${JSON.stringify(buyers, null, 2)}</pre>`;
                
                // Get lots
                const lotsRes = await fetch('/api/lots');
                const lots = await lotsRes.json();
                document.getElementById('lots-data').innerHTML = 
                    `<pre>${JSON.stringify(lots.slice(0, 3), null, 2)}</pre>`;
                
                // Get bags for first lot
                if (lots.length > 0) {
                    const bagsRes = await fetch(`/api/lots/${lots[0].id}/bags`);
                    const bags = await bagsRes.json();
                    document.getElementById('bags-data').innerHTML = 
                        `<pre>Bags for lot ${lots[0].lotNumber}:\n${JSON.stringify(bags, null, 2)}</pre>`;
                }
                
                // Get buyer bills
                const billsRes = await fetch('/api/billing/buyers/daily/2025-06-26');
                const bills = await billsRes.json();
                document.getElementById('bills-data').innerHTML = 
                    `<pre>${JSON.stringify(bills, null, 2)}</pre>`;
                
            } catch (error) {
                console.error('Test failed:', error);
                document.body.innerHTML += `<div style="color: red;">Error: ${error.message}</div>`;
            }
        }
        
        // Run test when page loads
        testBuyerBilling();
    </script>
</body>
</html>